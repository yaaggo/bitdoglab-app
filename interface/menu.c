#include "menu.h"
#include "include/joystick.h"
#include "include/button.h"
#include "include/led.h"
#include "include/buzzer.h"
#include "include/matrix.h"
#include "pico/bootrom.h"
#include <stdio.h>

#define DEBUG(VAR) printf("%s: %d\n", #VAR, VAR)
#define WRAP_CURSOR(value, max) (value + max) % max

const uint8_t bitdoglab_logo	 	   [];
const uint8_t led_button_idle	 	   [];
const uint8_t led_button_selected	   [];
const uint8_t matrix_button_idle 	   [];
const uint8_t matrix_button_selected   [];
const uint8_t joystick_button_idle     [];
const uint8_t joystick_button_selected [];
const uint8_t buzzer_button_idle 	   [];
const uint8_t buzzer_button_selected   [];
const uint8_t mic_button_idle 	   	   [];
const uint8_t mic_button_selected      [];
const uint8_t display_button_idle 	   [];
const uint8_t display_button_selected  [];

menu_states state = MENU_INITIAL;
button_event button_state = BUTTON_NONE;

volatile int8_t menu_cursor = 0;
volatile int8_t menu_page = 0;

volatile int8_t led_cursor = 0;
volatile int8_t led_selected[3] = {0, 0, 0};

volatile uint8_t buzzer_x = 15;
volatile uint8_t buzzer_on = 0;

volatile uint8_t cube_x = DISPLAY_WIDTH / 2 - 4;
volatile uint8_t cube_y = DISPLAY_HEIGHT / 2 - 4;

volatile bool grid[5][5] = { 0 };
volatile uint8_t grid_x = 0;
volatile uint8_t grid_y = 0;
const uint8_t GRID_ROWS = 5;
const uint8_t GRID_COLS = 5;
const uint8_t GRID_CELL_SIZE = 10;
const uint8_t GRID_GAP = 1;
const uint8_t GRID_MARGIN_TOP = 5;


void menu(display *dp) {
	switch(state) {
		case MENU_INITIAL:
			menu_initial_handle(menu_page, menu_cursor, dp);
		break;

		case MENU_LED:
			menu_led_handle(dp);
		break;

		case MENU_MATRIX:
			menu_matrix_handle(dp);
		break;

		case MENU_JOYSTICK:
			menu_joystick_handle(dp);
		break;

		case MENU_BUZZER:
			menu_buzzer_handle(dp);
		break;

		case MENU_MIC:
			menu_mic_handle(dp);
		break;

		case MENU_DISPLAY:
			menu_display_handle(dp);
		break;
			
	}
	if (button_get_event() == BUTTON_B) {
		state = MENU_INITIAL;
		button_clear_event();
	}
}

void menu_initial_handle(uint8_t page, uint8_t cursor, display *dp) {
	int8_t direction = joystick_read(JOYSTICK_X_PIN, 10, 50);
	DEBUG(direction);
	DEBUG(menu_cursor);
	DEBUG(menu_page);

	if(button_get_event() == BUTTON_JOYSTICK) {
		display_shutdown(dp);
		button_clear_event();
		reset_usb_boot(0, 0);
	}

	if (direction > 0) {
		menu_cursor = WRAP_CURSOR(menu_cursor + 1, 3);
		if (menu_cursor == 0) menu_page = !menu_page;
	} else if(direction < 0) {
		menu_cursor = WRAP_CURSOR(menu_cursor - 1, 3);
		if (menu_cursor == 2) menu_page = !menu_page;
	}
	
	if (button_get_event() == BUTTON_A) {
		const menu_states pages[2][3] = {
			{MENU_LED, MENU_MATRIX, MENU_JOYSTICK},
			{MENU_BUZZER, MENU_MIC, MENU_DISPLAY}
		};
		state = pages[menu_page][menu_cursor];
		button_clear_event();
	}

    display_draw_bitmap(18, 2, bitdoglab_logo, 90, 12, 0, true, dp);
	if(page == 0) {
		display_draw_bitmap(
			14, 36,
			cursor == 0 ? led_button_selected : led_button_idle,
			24, 24, 0,
			true, dp
		);

		display_draw_bitmap(
			52, 36,
			cursor == 1 ? matrix_button_selected : matrix_button_idle,
			24, 24, 0,
			true, dp
		);
		display_draw_bitmap(
			90, 36,
			cursor == 2 ? joystick_button_selected : joystick_button_idle,
			24, 24, 0,
			true, dp
		);
	} else {
		display_draw_bitmap(
			14, 36,
			cursor == 0 ? buzzer_button_selected : buzzer_button_idle,
			24, 24, 0,
			true, dp
		);
		display_draw_bitmap(
			52, 36,
			cursor == 1 ? mic_button_selected : mic_button_idle,
			24, 24, 0,
			true, dp
		);
		display_draw_bitmap(
			90, 36,
			cursor == 2 ? display_button_selected : display_button_idle,
			24, 24, 0,
			true, dp
		);
	}
}

void menu_led_handle(display *dp) {
	int8_t direction = joystick_read(JOYSTICK_Y_PIN, 10, 50);
	char * colors[3] = {"RED", "GREEN", "BLUE"};
	uint8_t leds[3] = {LED_RED_PIN, LED_GREEN_PIN, LED_BLUE_PIN};
	uint8_t sum[3] = {8, 0, 4};

	DEBUG(direction);

	if (direction < 0) {
		led_cursor = WRAP_CURSOR(led_cursor + 1, 3);
	} else if(direction > 0) {
		led_cursor = WRAP_CURSOR(led_cursor - 1, 3);
	}

	if (button_get_event() == BUTTON_A) {
		led_selected[led_cursor] = !led_selected[led_cursor];
		led_intensity(leds[led_cursor], 50 * led_selected[led_cursor]);
		button_clear_event();
	}

	for(int i = 0; i < 3; i++) {
		if(led_selected[i]) {
			display_draw_rectangle(14, 6 + i * 18, 114, 22 + i * 18, true, true, dp);
			display_draw_string(14 + 30 + sum[i] + 1, 11 + i * 18, colors[i], false, dp);
			if (led_cursor == i) 
			display_draw_rectangle(15, 7 + 18 * led_cursor, 113, 21 + 18 * led_cursor, false, false, dp);
		} else {
			display_draw_rectangle(14, 6 + i * 18, 114, 22 + i * 18, false, true, dp);
			display_draw_string(14 + 30 + sum[i] + 1, 11 + i * 18, colors[i], true, dp);
			if (led_cursor == i)
			display_draw_rectangle(15, 7 + 18 * led_cursor, 113, 21 + 18 * led_cursor, false, true, dp);
		}
	}
}

void menu_matrix_handle(display *dp) {
	const uint8_t grid_total_width = GRID_COLS * GRID_CELL_SIZE + (GRID_COLS - 1) * GRID_GAP;
    const uint8_t grid_start_x = (DISPLAY_WIDTH - grid_total_width) / 2;
    const uint8_t grid_start_y = GRID_MARGIN_TOP;

	int16_t joystick_x = joystick_read(JOYSTICK_X_PIN, 10, 30);
	int16_t joystick_y = joystick_read(JOYSTICK_Y_PIN, 10, 30);

	if (joystick_x > 0) {
		grid_x = WRAP_CURSOR(grid_x + 1, 5);
	} else if(joystick_x < 0) {
		grid_x = WRAP_CURSOR(grid_x - 1, 5);
	}

	if (joystick_y < 0) {
		grid_y = WRAP_CURSOR(grid_y + 1, 5);
	} else if(joystick_y > 0) {
		grid_y = WRAP_CURSOR(grid_y - 1, 5);
	}

	if (button_get_event() == BUTTON_A) {
		grid[grid_y][grid_x] = !grid[grid_y][grid_x];
		matrix_set_led_horizontally(grid_y * 5 + grid_x, COLOR_RGB(30 * grid[grid_y][grid_x], 30 * grid[grid_y][grid_x], 30 * grid[grid_y][grid_x]) );
		matrix_update();
		button_clear_event();
	}

    for (uint8_t row = 0; row < GRID_ROWS; row++) {
        for (uint8_t col = 0; col < GRID_COLS; col++) {
            const uint8_t x = grid_start_x + col * (GRID_CELL_SIZE + GRID_GAP);
            const uint8_t y = grid_start_y + row * (GRID_CELL_SIZE + GRID_GAP);
            display_draw_rectangle(x, y, x + GRID_CELL_SIZE - 1, y + GRID_CELL_SIZE - 1, false, true, dp);
			display_draw_rectangle(x, y, x + GRID_CELL_SIZE - 1, y + GRID_CELL_SIZE - 1, grid[row][col], true, dp);
			if (grid_x == col && grid_y == row)
				display_draw_rectangle(x+1, y+1, x + GRID_CELL_SIZE - 2, y + GRID_CELL_SIZE - 2, false, !grid[row][col], dp);
        }
    }

	// aqui tem a lógica para usar o joystick
}

void menu_joystick_handle(display *dp) {
	int8_t y = joystick_read(JOYSTICK_Y_PIN, 0, 30);
	int8_t x = joystick_read(JOYSTICK_X_PIN, 0, 30);
	display_draw_circle(64, 32, 30, false, true, dp);
	display_draw_circle(64 + x, 32 - y, 10, false, true, dp);
}

void menu_buzzer_handle(display *dp) {
	uint8_t max_x = 113, min_x = 15;
	int8_t x = joystick_read(JOYSTICK_X_PIN, 0, 10);
	display_draw_rectangle(14, 20, 114, 40, false, true, dp);

	if(buzzer_x + x <= max_x && buzzer_x + x >= min_x)
		buzzer_x += x; 

	display_draw_rectangle(15, 21, buzzer_x, 39, true, true, dp);

	if (button_get_event() == BUTTON_A) {
		buzzer_on = !buzzer_on;
		if(buzzer_on)
			buzzer_turn_on(BUZZER_A_PIN, 20 * buzzer_x);
		else
			buzzer_turn_on(BUZZER_A_PIN, 0);
		button_clear_event();
	}

	if(buzzer_on) {
		display_draw_rectangle(44, 44, 84, 60, true, true, dp);
		display_draw_string(50, 48, "PLAY", false, dp);
	} else {
		display_draw_rectangle(44, 44, 84, 60, false, true, dp);
		display_draw_string(50, 49, "PLAY", true, dp);
	}

}

// não vai ser feito por agora
void menu_mic_handle(display *dp) {
	display_draw_string(32, 22, "nada aqui", true, dp);
}

void menu_display_handle(display *dp) {
    uint8_t previous_cube_x = cube_x;
    uint8_t previous_cube_y = cube_y;

	int16_t joystick_x = joystick_read(JOYSTICK_X_PIN, 0, 15);
	int16_t joystick_y = -joystick_read(JOYSTICK_Y_PIN, 0, 15);

	display_draw_rectangle(0, 0, 127, 63, false, true, dp);
    display_draw_rectangle(cube_x, cube_y, cube_x + 8, cube_y + 8, true, true, dp);

	cube_x = (cube_x + joystick_x + DISPLAY_WIDTH) % DISPLAY_WIDTH;
    cube_y = (cube_y + joystick_y + DISPLAY_HEIGHT) % DISPLAY_HEIGHT;

	if(previous_cube_x != cube_x || previous_cube_y != cube_y) {
		display_draw_rectangle(previous_cube_x, previous_cube_y, previous_cube_x + 8, previous_cube_y + 8, true, false, dp);
		display_draw_rectangle(cube_x, cube_y, cube_x + 8, cube_y + 8, true, true, dp);
		previous_cube_x = cube_x;
		previous_cube_y = cube_y;
	}

	display_draw_rectangle(0, 0, 127, 63, false, true, dp);   
}


const uint8_t bitdoglab_logo [] = {
	0x00, 0x00, 0x00, 0x00, 0xfe, 0x02, 0x22, 0x22, 0x22, 0x26, 0x3c, 0x60, 0xc0, 0x00, 0x00, 0x04, 
	0x04, 0x84, 0xfc, 0x04, 0x04, 0x00, 0x04, 0x04, 0x04, 0xff, 0x04, 0x04, 0x04, 0x00, 0x00, 0x00, 
	0x00, 0xfc, 0x06, 0x06, 0x04, 0x04, 0x0c, 0x18, 0xf0, 0x00, 0xf8, 0x08, 0x04, 0x04, 0x04, 0x0c, 
	0x18, 0xf0, 0x00, 0xc0, 0x70, 0x18, 0x88, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0xfc, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xe0, 0x38, 0xf0, 0x00, 0x00, 0x00, 0xfe, 0x02, 0x22, 
	0x22, 0x22, 0x26, 0x3c, 0x60, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x06, 
	0x04, 0x04, 0x04, 0x06, 0x02, 0x03, 0x01, 0x00, 0x02, 0x02, 0x02, 0x03, 0x02, 0x02, 0x02, 0x00, 
	0x00, 0x00, 0x06, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x07, 0x04, 0x04, 0x04, 0x04, 
	0x06, 0x02, 0x03, 0x00, 0x03, 0x06, 0x04, 0x04, 0x04, 0x06, 0x03, 0x01, 0x00, 0x03, 0x06, 0x04, 
	0x04, 0x04, 0x05, 0x07, 0x00, 0x00, 0x00, 0x00, 0x03, 0x06, 0x04, 0x04, 0x04, 0x06, 0x00, 0x06, 
	0x03, 0x02, 0x02, 0x03, 0x06, 0x00, 0x00, 0x03, 0x06, 0x04, 0x04, 0x04, 0x06, 0x02, 0x03, 0x01, 
	0x00, 0x00, 0x00, 0x00
};

const uint8_t led_button_idle [] = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x30, 0x08, 0x08, 0x08, 0x08, 0x30, 0xc0, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x03, 0xf2, 0x0e, 0x02, 0x02, 0xfe, 0x02, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1c, 0x03, 0x00, 0x00, 0x00, 0x1f, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

const uint8_t led_button_selected [] = {
	0xff, 0x01, 0x01, 0x89, 0x89, 0x99, 0x11, 0x01, 0xc1, 0xf1, 0xf9, 0xf9, 0xf9, 0xf9, 0xf1, 0xc1, 
	0x11, 0x19, 0x0d, 0x85, 0x81, 0x01, 0x01, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x00, 
	0x03, 0xf3, 0x0f, 0x03, 0x03, 0xff, 0x03, 0x03, 0x00, 0x03, 0x01, 0x01, 0x00, 0x00, 0x00, 0xff, 
	0xff, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x9c, 0x83, 0x80, 0x80, 0x80, 0x9f, 0x80, 0x80, 
	0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0xff
};

const uint8_t matrix_button_idle [] = {
	0x00, 0x00, 0xfc, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0xfc, 0x00, 0x00, 0xfc, 0x04, 0x04, 
	0x04, 0x04, 0x04, 0x04, 0x04, 0xfc, 0x00, 0x00, 0x00, 0x00, 0xe7, 0x24, 0x24, 0x24, 0x24, 0x24, 
	0x24, 0x24, 0xe7, 0x00, 0x00, 0xe7, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0xe7, 0x00, 0x00, 
	0x00, 0x00, 0x3f, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3f, 0x00, 0x00, 0x3f, 0x20, 0x20, 
	0x20, 0x20, 0x20, 0x20, 0x20, 0x3f, 0x00, 0x00
};

const uint8_t matrix_button_selected [] = {
	0xff, 0x01, 0xfd, 0xfd, 0xfd, 0xfd, 0xfd, 0xfd, 0xfd, 0xfd, 0xfd, 0x01, 0x01, 0xfd, 0x05, 0x05, 
	0x05, 0x05, 0x05, 0x05, 0x05, 0xfd, 0x01, 0xff, 0xff, 0x00, 0xe7, 0x27, 0x27, 0x27, 0x27, 0x27, 
	0x27, 0x27, 0xe7, 0x00, 0x00, 0xe7, 0xe4, 0xe4, 0xe4, 0xe4, 0xe4, 0xe4, 0xe4, 0xe7, 0x00, 0xff, 
	0xff, 0x80, 0xbf, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0xbf, 0x80, 0x80, 0xbf, 0xbf, 0xbf, 
	0xbf, 0xbf, 0xbf, 0xbf, 0xbf, 0xbf, 0x80, 0xff
};

const uint8_t joystick_button_idle [] = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x78, 0xc4, 0x84, 0x84, 0xc4, 0x78, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x80, 0x40, 0x7f, 0x40, 0x40, 0x7f, 0x40, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x0e, 0x1a, 0x32, 0x22, 0x22, 0x23, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 
	0x23, 0x22, 0x32, 0x12, 0x1a, 0x0e, 0x00, 0x00
};

const uint8_t joystick_button_selected [] = {
	0xff, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x79, 0xc5, 0x85, 0x85, 0xc5, 0x79, 0x01, 
	0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x80, 0x40, 0x7f, 0x40, 0x40, 0x7f, 0x40, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 
	0xff, 0x80, 0x8e, 0x9a, 0xb2, 0xa2, 0xa2, 0xa3, 0xa2, 0xa2, 0xa2, 0xa2, 0xa2, 0xa2, 0xa2, 0xa2, 
	0xa3, 0xa2, 0xb2, 0x92, 0x9a, 0x8e, 0x80, 0xff
};

const uint8_t buzzer_button_idle [] = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfc, 0x78, 0xf0, 0xc0, 
	0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x01, 0x27, 0x3f, 0x1e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x1e, 0x3e, 0x3f, 0x3f, 0x3f, 0x3f, 0x1e, 0x1e, 0x0c, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

const uint8_t buzzer_button_selected [] = {
	0xff, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xfd, 0x79, 0xf1, 0xc1, 
	0x81, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x01, 0x27, 0x3f, 0x1e, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 
	0xff, 0x80, 0x80, 0x80, 0x80, 0x80, 0x8c, 0x9e, 0xbe, 0xbf, 0xbf, 0xbf, 0xbf, 0x9e, 0x9e, 0x8c, 
	0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0xff
};

const uint8_t mic_button_idle [] = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf0, 0xa8, 0x54, 0xac, 0x54, 0xac, 0x54, 0xa8, 
	0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x01, 0x02, 0x05, 0xfe, 0x05, 0xfe, 0x05, 0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1f, 0x10, 0x1f, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

const uint8_t mic_button_selected [] = {
	0xff, 0x01, 0x81, 0xf1, 0x11, 0x91, 0xf1, 0x01, 0xf1, 0xa9, 0x55, 0xad, 0x55, 0xad, 0x55, 0xa9, 
	0xf1, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xff, 0xff, 0x00, 0x01, 0x01, 0x00, 0x01, 0x01, 0x00, 
	0x01, 0x02, 0x05, 0xfe, 0x05, 0xfe, 0x05, 0x02, 0x01, 0x00, 0x00, 0x80, 0x80, 0x00, 0x00, 0xff, 
	0xff, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x9f, 0x90, 0x9f, 0x80, 0x80, 
	0x80, 0x80, 0x8c, 0x8f, 0x80, 0x83, 0x80, 0xff
};


const uint8_t display_button_idle [] = {
	0x00, 0x00, 0xc0, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 
	0x40, 0x40, 0x40, 0x40, 0x40, 0xc0, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 
	0x00, 0x00, 0x03, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 
	0x02, 0x02, 0x02, 0x02, 0x02, 0x03, 0x00, 0x00
};

const uint8_t display_button_selected [] = {
	0xff, 0x01, 0xe1, 0x21, 0x21, 0x21, 0xa1, 0x21, 0xa1, 0xa1, 0xa1, 0x21, 0xa1, 0x21, 0xa1, 0xa1, 
	0xa1, 0x21, 0x21, 0x21, 0x21, 0xe1, 0x01, 0xff, 0xff, 0x00, 0xff, 0x00, 0xe0, 0x20, 0x21, 0xe1, 
	0x00, 0x01, 0xe4, 0x24, 0x25, 0xe4, 0x01, 0x01, 0xe0, 0xe1, 0xe0, 0xe0, 0x00, 0xff, 0x00, 0xff, 
	0xff, 0x80, 0x87, 0x84, 0x85, 0x85, 0x85, 0x85, 0x84, 0x84, 0x85, 0x85, 0x85, 0x85, 0x84, 0x84, 
	0x85, 0x85, 0x85, 0x85, 0x84, 0x87, 0x80, 0xff
};